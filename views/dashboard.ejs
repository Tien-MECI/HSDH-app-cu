<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Dashboard Kinh Doanh</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    h1 { text-align: center; }
    .charts { display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-top: 20px; }
    .chart-container { background: #fff; padding: 15px; border-radius: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 6px; text-align: center; }
    th { background: #f0f0f0; }
  </style>
</head>
<body>

<h1>üìä Dashboard Kinh Doanh</h1>

<div class="charts">
  <div class="chart-container">
    <h3>Doanh thu theo th√°ng</h3>
    <canvas id="revenueChart"></canvas>
  </div>
  <div class="chart-container">
    <h3>L·ª£i nhu·∫≠n theo th√°ng</h3>
    <canvas id="profitChart"></canvas>
  </div>
</div>

<h3 style="margin-top: 30px;">T·ª∑ l·ªá ch·ªët ƒë∆°n: <%= conversionRate %>%</h3>

<h3>Top s·∫£n ph·∫©m b√°n ch·∫°y</h3>
<table>
  <thead>
    <tr>
      <th>M√£ SP</th>
      <th>S·ªë l∆∞·ª£ng</th>
      <th>ƒêVT</th>
    </tr>
  </thead>
  <tbody>
    <% topProducts.forEach(item => { %>
      <tr>
        <td><%= item.maSP %></td>
        <td><%= item.sumFormatted %></td>
        <td><%= item.dvt %></td>
      </tr>
    <% }) %>
  </tbody>
</table>

<script>
  const revenueData = <%- JSON.stringify(revenue) %>;
  const profitData = <%- JSON.stringify(profit) %>;

  const months = Object.keys(revenueData).map(m => "T" + m);

  new Chart(document.getElementById("revenueChart"), {
    type: "bar",
    data: {
      labels: months,
      datasets: [{
        label: "Doanh thu",
        data: Object.values(revenueData),
        borderWidth: 1
      }]
    }
  });

  new Chart(document.getElementById("profitChart"), {
    type: "bar",
    data: {
      labels: months,
      datasets: [{
        label: "L·ª£i nhu·∫≠n",
        data: Object.values(profitData),
        borderWidth: 1
      }]
    }
  });
</script>

</body>
</html>
