<!DOCTYPE html>
<html>
<head>
    <title>Yêu Cầu Vật Tư</title>
    <meta charset="UTF-8">
    <style>
        @page { size: A4 portrait; margin: 1cm; }
        body { font-family: Arial, sans-serif; font-size: 12px; margin: 0; padding: 15px; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 10px; font-size: 12px; }
        th, td { border: 1px solid black; padding: 4px; text-align: center; }
        .center-text { text-align: center; }
        .bold { font-weight: bold; }
        .yellow { background: #FFFF00; }
        .no-border { border: none; }
        <% if (!hasDataE) { %> .col-e { display: none; } <% } %>
        <% if (!hasDataI) { %> .col-i { display: none; } <% } %>
    </style>
</head>
<body>
    <h1 class="center-text bold" style="font-size: 25px;">YÊU CẦU VẬT TƯ</h1>

    <h2 class="center-text bold">BẢNG CHI TIẾT VẬT TƯ</h2>
    <table style="font-size: 18px;">
        <!--
        <thead>
            <tr>
                <th>A: STT</th>
                <th>B: Mã SP</th>
                <th>C: Mã vật tư</th>
                <th>D: Mô tả</th>
                <th class="col-e">E: Số lượng</th>
                <th>F: Cân nặng</th>
                <th>G: Dài</th>
                <th>H: Rộng</th>
                <th class="col-i">I: Cao</th>
                <th>J: Tổng SL</th>
                <th>K: Tổng m2</th>
                <th>L: Đơn vị</th>
                <th>M: Ghi chú</th>
            </tr>
        </thead>
        -->
        <tbody>
            <% tableData.forEach((item) => { %>
                <tr>
                    <td><%= item.stt %></td> <!-- STT -->
                    <% item.row.forEach((cell, idx) => { %>
                        <td class="<%= idx === 4 ? 'col-e' : idx === 8 ? 'col-i' : '' %>">
                            <%= cell || '' %>
                        </td>
                    <% }) %>
                </tr>
            <% }) %>
        </tbody>
    </table>

    <h2 class="center-text yellow bold" style="font-size: 22px;">BẢNG TỔNG HỢP VẬT TƯ - SẢN PHẨM</h2>
    <table style="font-size: 18px;">
        <thead>
            <tr>
                <th>STT</th>
                <th>Mã SP</th>
                <th>Mã vật tư</th>
                <th>Mô tả</th>
                <th>Tổng số lượng</th>
            </tr>
        </thead>
        <tbody>
            <% summaryDataB.forEach(item => { %>
                <tr>
                    <td><%= item.stt %></td>
                    <td><%= item.b %></td>
                    <td></td>
                    <td><%= item.desc %></td>
                    <td><%= item.sum %></td>
                </tr>
            <% }) %>
            <% summaryDataC.forEach(item => { %>
                <tr>
                    <td><%= item.stt %></td>
                    <td></td>
                    <td><%= item.c %></td>
                    <td><%= item.desc %></td>
                    <td><%= item.sum %></td>
                </tr>
            <% }) %>
        </tbody>
    </table>
</body>
</html>
